// Assignment 3 - Structured Thinking \\
use role accountadmin;


SELECT AVG(TOTAL_ELAPSED_TIME) 
FROM SNOWFLAKE.ACCOUNT_USAGE.QUERY_HISTORY
WHERE START_TIME BETWEEN DATE_TRUNC('MONTH', CURRENT_DATE()) AND CURRENT_DATE();


SELECT
  DATE_TRUNC('DAY', START_TIME) AS query_day,
  AVG(TOTAL_ELAPSED_TIME) AS avg_total_elapsed_time
FROM
  SNOWFLAKE.ACCOUNT_USAGE.QUERY_HISTORY
WHERE
  START_TIME BETWEEN DATE_TRUNC('MONTH', CURRENT_DATE()) AND CURRENT_DATE()
GROUP BY
  query_day
ORDER BY
  query_day;
